<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Untitled</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="CoolUtils HTML exporter" />
<style type="text/css">
<!--
body { color: #000000; background-color: #FFFFFF; }
.python1-classname { color: #000080; font-weight: bold; }
.python1-comment { color: #808080; font-style: italic; }
.python1-commentedcode { color: #C0C0C0; font-style: italic; }
.python1-documentation { color: #CC00FF; }
.python1-float { color: #008080; }
.python1-functionname { color: #008080; font-weight: bold; }
.python1-hexadecimal { color: #008080; }
.python1-identifier { color: #000000; }
.python1-matchingbrace { color: #0000FF; font-weight: bold; }
.python1-multi-linestring { color: #808000; }
.python1-nonreservedkeyword { color: #000080; }
.python1-number { color: #008080; }
.python1-octal { color: #008080; }
.python1-reservedword { font-weight: bold; }
.python1-space { color: #C0C0C0; }
.python1-string { color: #808000; }
.python1-symbol { color: #800000; }
.python1-syntaxerror { color: #FF0000; }
.python1-systemfunctionsandvariables { font-weight: bold; }
.python1-unbalancedbrace { color: #FFFF00; }
-->
</style>
</head>
<body>
<!--StartFragment--><pre><code><span class="python1-reservedword">import</span><span class="python1-space"> </span><span class="python1-identifier">streamlit</span><span class="python1-space"> </span><span class="python1-reservedword">as</span><span class="python1-space"> </span><span class="python1-identifier">st
</span><span class="python1-reservedword">import</span><span class="python1-space"> </span><span class="python1-identifier">pandas</span><span class="python1-space"> </span><span class="python1-reservedword">as</span><span class="python1-space"> </span><span class="python1-identifier">pd
</span><span class="python1-reservedword">import</span><span class="python1-space"> </span><span class="python1-identifier">numpy</span><span class="python1-space"> </span><span class="python1-reservedword">as</span><span class="python1-space"> </span><span class="python1-identifier">np
</span><span class="python1-reservedword">import</span><span class="python1-space"> </span><span class="python1-identifier">sys
</span><span class="python1-reservedword">import</span><span class="python1-space"> </span><span class="python1-identifier">os
</span><span class="python1-reservedword">from</span><span class="python1-space"> </span><span class="python1-identifier">sklearn</span><span class="python1-symbol">.</span><span class="python1-identifier">preprocessing</span><span class="python1-space"> </span><span class="python1-reservedword">import</span><span class="python1-space"> </span><span class="python1-identifier">LabelEncoder
</span><span class="python1-reservedword">from</span><span class="python1-space"> </span><span class="python1-identifier">sklearn</span><span class="python1-symbol">.</span><span class="python1-identifier">metrics</span><span class="python1-space"> </span><span class="python1-reservedword">import</span><span class="python1-space"> </span><span class="python1-identifier">confusion_matrix
</span><span class="python1-reservedword">from</span><span class="python1-space"> </span><span class="python1-identifier">sklearn</span><span class="python1-symbol">.</span><span class="python1-identifier">model_selection</span><span class="python1-space"> </span><span class="python1-reservedword">import</span><span class="python1-space"> </span><span class="python1-identifier">train_test_split
</span><span class="python1-reservedword">from</span><span class="python1-space"> </span><span class="python1-identifier">sklearn</span><span class="python1-symbol">.</span><span class="python1-identifier">naive_bayes</span><span class="python1-space"> </span><span class="python1-reservedword">import</span><span class="python1-space"> </span><span class="python1-identifier">GaussianNB
</span><span class="python1-reservedword">from</span><span class="python1-space"> </span><span class="python1-identifier">sklearn</span><span class="python1-symbol">.</span><span class="python1-identifier">metrics</span><span class="python1-space"> </span><span class="python1-reservedword">import</span><span class="python1-space"> </span><span class="python1-identifier">accuracy_score
</span><span class="python1-reservedword">import</span><span class="python1-space"> </span><span class="python1-identifier">matplotlib</span><span class="python1-symbol">.</span><span class="python1-identifier">pyplot</span><span class="python1-space"> </span><span class="python1-reservedword">as</span><span class="python1-space"> </span><span class="python1-identifier">plt
</span><span class="python1-reservedword">import</span><span class="python1-space"> </span><span class="python1-identifier">seaborn</span><span class="python1-space"> </span><span class="python1-reservedword">as</span><span class="python1-space"> </span><span class="python1-identifier">sns

</span><span class="python1-comment"># ==========================================
# Naive Bayes Classifier Function
# ==========================================
</span><span class="python1-reservedword">def</span><span class="python1-space"> </span><span class="python1-functionname">naive_bayes_classifier</span><span class="python1-symbol">(</span><span class="python1-identifier">X</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">y</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">test_size</span><span class="python1-symbol">=</span><span class="python1-float">0.2</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">random_state</span><span class="python1-symbol">=</span><span class="python1-number">42</span><span class="python1-symbol">):
</span><span class="python1-space">    </span><span class="python1-documentation">&quot;&quot;&quot;
    Trains a Naive Bayes classifier and returns comprehensive metrics.
    
    Parameters:
    -----------
    X : array-like
        Feature matrix (dataset features)
    y : array-like
        Target variable (labels)
    test_size : float
        Proportion of dataset to include in test split (default: 0.2)
    random_state : int
        Random seed for reproducibility (default: 42)
    
    Returns:
    --------
    dict : Dictionary containing model and performance metrics
    &quot;&quot;&quot;
</span><span class="python1-space">    
    </span><span class="python1-comment"># Split the dataset into training and testing sets
</span><span class="python1-space">    </span><span class="python1-identifier">X_train</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">X_test</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">y_train</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">y_test</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">train_test_split</span><span class="python1-symbol">(
</span><span class="python1-space">        </span><span class="python1-identifier">X</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">y</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">test_size</span><span class="python1-symbol">=</span><span class="python1-identifier">test_size</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">random_state</span><span class="python1-symbol">=</span><span class="python1-identifier">random_state
</span><span class="python1-space">    </span><span class="python1-symbol">)
</span><span class="python1-space">    
    </span><span class="python1-comment"># Create a Gaussian Naive Bayes classifier
</span><span class="python1-space">    </span><span class="python1-identifier">model</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">GaussianNB</span><span class="python1-symbol">()
</span><span class="python1-space">    
    </span><span class="python1-comment"># Fit the model to the training data
</span><span class="python1-space">    </span><span class="python1-identifier">model</span><span class="python1-symbol">.</span><span class="python1-identifier">fit</span><span class="python1-symbol">(</span><span class="python1-identifier">X_train</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">y_train</span><span class="python1-symbol">)
</span><span class="python1-space">    
    </span><span class="python1-comment"># Predict labels for training and testing sets
</span><span class="python1-space">    </span><span class="python1-identifier">y_train_pred</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">model</span><span class="python1-symbol">.</span><span class="python1-identifier">predict</span><span class="python1-symbol">(</span><span class="python1-identifier">X_train</span><span class="python1-symbol">)
</span><span class="python1-space">    </span><span class="python1-identifier">y_test_pred</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">model</span><span class="python1-symbol">.</span><span class="python1-identifier">predict</span><span class="python1-symbol">(</span><span class="python1-identifier">X_test</span><span class="python1-symbol">)
</span><span class="python1-space">    
    </span><span class="python1-comment"># Calculate training accuracy
</span><span class="python1-space">    </span><span class="python1-identifier">training_accuracy</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">accuracy_score</span><span class="python1-symbol">(</span><span class="python1-identifier">y_train</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">y_train_pred</span><span class="python1-symbol">)
</span><span class="python1-space">    
    </span><span class="python1-comment"># Calculate testing accuracy
</span><span class="python1-space">    </span><span class="python1-identifier">testing_accuracy</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">accuracy_score</span><span class="python1-symbol">(</span><span class="python1-identifier">y_test</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">y_test_pred</span><span class="python1-symbol">)
</span><span class="python1-space">    
    </span><span class="python1-comment"># Calculate confusion matrix for test set
</span><span class="python1-space">    </span><span class="python1-identifier">conf_matrix</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">confusion_matrix</span><span class="python1-symbol">(</span><span class="python1-identifier">y_test</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">y_test_pred</span><span class="python1-symbol">)
</span><span class="python1-space">    
    </span><span class="python1-comment"># Return comprehensive results
</span><span class="python1-space">    </span><span class="python1-identifier">results</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-symbol">{
</span><span class="python1-space">        </span><span class="python1-string">'model'</span><span class="python1-symbol">:</span><span class="python1-space"> </span><span class="python1-identifier">model</span><span class="python1-symbol">,
</span><span class="python1-space">        </span><span class="python1-string">'X_train'</span><span class="python1-symbol">:</span><span class="python1-space"> </span><span class="python1-identifier">X_train</span><span class="python1-symbol">,
</span><span class="python1-space">        </span><span class="python1-string">'X_test'</span><span class="python1-symbol">:</span><span class="python1-space"> </span><span class="python1-identifier">X_test</span><span class="python1-symbol">,
</span><span class="python1-space">        </span><span class="python1-string">'y_train'</span><span class="python1-symbol">:</span><span class="python1-space"> </span><span class="python1-identifier">y_train</span><span class="python1-symbol">,
</span><span class="python1-space">        </span><span class="python1-string">'y_test'</span><span class="python1-symbol">:</span><span class="python1-space"> </span><span class="python1-identifier">y_test</span><span class="python1-symbol">,
</span><span class="python1-space">        </span><span class="python1-string">'training_accuracy'</span><span class="python1-symbol">:</span><span class="python1-space"> </span><span class="python1-identifier">training_accuracy</span><span class="python1-symbol">,
</span><span class="python1-space">        </span><span class="python1-string">'testing_accuracy'</span><span class="python1-symbol">:</span><span class="python1-space"> </span><span class="python1-identifier">testing_accuracy</span><span class="python1-symbol">,
</span><span class="python1-space">        </span><span class="python1-string">'confusion_matrix'</span><span class="python1-symbol">:</span><span class="python1-space"> </span><span class="python1-identifier">conf_matrix</span><span class="python1-symbol">,
</span><span class="python1-space">        </span><span class="python1-string">'train_size'</span><span class="python1-symbol">:</span><span class="python1-space"> </span><span class="python1-nonreservedkeyword">len</span><span class="python1-symbol">(</span><span class="python1-identifier">X_train</span><span class="python1-symbol">),
</span><span class="python1-space">        </span><span class="python1-string">'test_size'</span><span class="python1-symbol">:</span><span class="python1-space"> </span><span class="python1-nonreservedkeyword">len</span><span class="python1-symbol">(</span><span class="python1-identifier">X_test</span><span class="python1-symbol">)
</span><span class="python1-space">    </span><span class="python1-symbol">}
</span><span class="python1-space">    
    </span><span class="python1-reservedword">return</span><span class="python1-space"> </span><span class="python1-identifier">results

st</span><span class="python1-symbol">.</span><span class="python1-identifier">set_page_config</span><span class="python1-symbol">(</span><span class="python1-identifier">page_title</span><span class="python1-symbol">=</span><span class="python1-string">&quot;Naive Bayes Classifier&quot;</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">layout</span><span class="python1-symbol">=</span><span class="python1-string">&quot;wide&quot;</span><span class="python1-symbol">)
</span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">title</span><span class="python1-symbol">(</span><span class="python1-string">&quot;рџ¤– Naive Bayes Classifier&quot;</span><span class="python1-symbol">)

</span><span class="python1-comment"># Sidebar for configuration
</span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">sidebar</span><span class="python1-symbol">.</span><span class="python1-identifier">header</span><span class="python1-symbol">(</span><span class="python1-string">&quot;Configuration&quot;</span><span class="python1-symbol">)

</span><span class="python1-comment"># ==========================================
# 1. CSV File Upload
# ==========================================
</span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">sidebar</span><span class="python1-symbol">.</span><span class="python1-identifier">subheader</span><span class="python1-symbol">(</span><span class="python1-string">&quot;1. Dataset Input&quot;</span><span class="python1-symbol">)
</span><span class="python1-identifier">uploaded_file</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">sidebar</span><span class="python1-symbol">.</span><span class="python1-identifier">file_uploader</span><span class="python1-symbol">(</span><span class="python1-string">&quot;Upload CSV file&quot;</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-nonreservedkeyword">type</span><span class="python1-symbol">=[</span><span class="python1-string">&quot;csv&quot;</span><span class="python1-symbol">])

</span><span class="python1-reservedword">if</span><span class="python1-space"> </span><span class="python1-identifier">uploaded_file</span><span class="python1-space"> </span><span class="python1-reservedword">is</span><span class="python1-space"> </span><span class="python1-reservedword">not</span><span class="python1-space"> </span><span class="python1-nonreservedkeyword">None</span><span class="python1-symbol">:
</span><span class="python1-space">    </span><span class="python1-comment"># Load dataset
</span><span class="python1-space">    </span><span class="python1-identifier">df</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">sidebar</span><span class="python1-symbol">.</span><span class="python1-identifier">checkbox</span><span class="python1-symbol">(</span><span class="python1-string">&quot;Show dataset preview&quot;</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">value</span><span class="python1-symbol">=</span><span class="python1-nonreservedkeyword">True</span><span class="python1-symbol">)
</span><span class="python1-space">    </span><span class="python1-identifier">data</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">pd</span><span class="python1-symbol">.</span><span class="python1-identifier">read_csv</span><span class="python1-symbol">(</span><span class="python1-identifier">uploaded_file</span><span class="python1-symbol">)
</span><span class="python1-space">    
    </span><span class="python1-reservedword">if</span><span class="python1-space"> </span><span class="python1-identifier">df</span><span class="python1-symbol">:
</span><span class="python1-space">        </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">subheader</span><span class="python1-symbol">(</span><span class="python1-string">&quot;рџ“Љ Dataset Preview&quot;</span><span class="python1-symbol">)
</span><span class="python1-space">        </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">write</span><span class="python1-symbol">(</span><span class="python1-identifier">f</span><span class="python1-string">&quot;Dataset shape: {data.shape}&quot;</span><span class="python1-symbol">)
</span><span class="python1-space">        </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">dataframe</span><span class="python1-symbol">(</span><span class="python1-identifier">data</span><span class="python1-symbol">.</span><span class="python1-identifier">head</span><span class="python1-symbol">(</span><span class="python1-number">10</span><span class="python1-symbol">))
</span><span class="python1-space">    
    </span><span class="python1-comment"># ==========================================
</span><span class="python1-space">    </span><span class="python1-comment"># 2. Feature and Target Selection
</span><span class="python1-space">    </span><span class="python1-comment"># ==========================================
</span><span class="python1-space">    </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">sidebar</span><span class="python1-symbol">.</span><span class="python1-identifier">subheader</span><span class="python1-symbol">(</span><span class="python1-string">&quot;2. Column Selection&quot;</span><span class="python1-symbol">)
</span><span class="python1-space">    </span><span class="python1-identifier">columns</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">data</span><span class="python1-symbol">.</span><span class="python1-identifier">columns</span><span class="python1-symbol">.</span><span class="python1-identifier">tolist</span><span class="python1-symbol">()
</span><span class="python1-space">    
    </span><span class="python1-identifier">target_column</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">sidebar</span><span class="python1-symbol">.</span><span class="python1-identifier">selectbox</span><span class="python1-symbol">(
</span><span class="python1-space">        </span><span class="python1-string">&quot;Select target column (y)&quot;</span><span class="python1-symbol">,
</span><span class="python1-space">        </span><span class="python1-identifier">columns</span><span class="python1-symbol">,
</span><span class="python1-space">        </span><span class="python1-nonreservedkeyword">help</span><span class="python1-symbol">=</span><span class="python1-string">&quot;The column containing labels/target values&quot;
</span><span class="python1-space">    </span><span class="python1-symbol">)
</span><span class="python1-space">    
    </span><span class="python1-identifier">feature_columns</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">sidebar</span><span class="python1-symbol">.</span><span class="python1-identifier">multiselect</span><span class="python1-symbol">(
</span><span class="python1-space">        </span><span class="python1-string">&quot;Select feature columns (X)&quot;</span><span class="python1-symbol">,
</span><span class="python1-space">        </span><span class="python1-symbol">[</span><span class="python1-identifier">col</span><span class="python1-space"> </span><span class="python1-reservedword">for</span><span class="python1-space"> </span><span class="python1-identifier">col</span><span class="python1-space"> </span><span class="python1-reservedword">in</span><span class="python1-space"> </span><span class="python1-identifier">columns</span><span class="python1-space"> </span><span class="python1-reservedword">if</span><span class="python1-space"> </span><span class="python1-identifier">col</span><span class="python1-space"> </span><span class="python1-symbol">!=</span><span class="python1-space"> </span><span class="python1-identifier">target_column</span><span class="python1-symbol">],
</span><span class="python1-space">        </span><span class="python1-identifier">default</span><span class="python1-symbol">=[</span><span class="python1-identifier">col</span><span class="python1-space"> </span><span class="python1-reservedword">for</span><span class="python1-space"> </span><span class="python1-identifier">col</span><span class="python1-space"> </span><span class="python1-reservedword">in</span><span class="python1-space"> </span><span class="python1-identifier">columns</span><span class="python1-space"> </span><span class="python1-reservedword">if</span><span class="python1-space"> </span><span class="python1-identifier">col</span><span class="python1-space"> </span><span class="python1-symbol">!=</span><span class="python1-space"> </span><span class="python1-identifier">target_column</span><span class="python1-symbol">],
</span><span class="python1-space">        </span><span class="python1-nonreservedkeyword">help</span><span class="python1-symbol">=</span><span class="python1-string">&quot;The columns containing features/predictors&quot;
</span><span class="python1-space">    </span><span class="python1-symbol">)
</span><span class="python1-space">    
    </span><span class="python1-reservedword">if</span><span class="python1-space"> </span><span class="python1-reservedword">not</span><span class="python1-space"> </span><span class="python1-identifier">feature_columns</span><span class="python1-symbol">:
</span><span class="python1-space">        </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">error</span><span class="python1-symbol">(</span><span class="python1-string">&quot;Please select at least one feature column!&quot;</span><span class="python1-symbol">)
</span><span class="python1-space">        </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">stop</span><span class="python1-symbol">()
</span><span class="python1-space">    
    </span><span class="python1-comment"># ==========================================
</span><span class="python1-space">    </span><span class="python1-comment"># 3. Training/Testing Split
</span><span class="python1-space">    </span><span class="python1-comment"># ==========================================
</span><span class="python1-space">    </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">sidebar</span><span class="python1-symbol">.</span><span class="python1-identifier">subheader</span><span class="python1-symbol">(</span><span class="python1-string">&quot;3. Train-Test Split&quot;</span><span class="python1-symbol">)
</span><span class="python1-space">    </span><span class="python1-identifier">test_size</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">sidebar</span><span class="python1-symbol">.</span><span class="python1-identifier">slider</span><span class="python1-symbol">(
</span><span class="python1-space">        </span><span class="python1-string">&quot;Test set size (%)&quot;</span><span class="python1-symbol">,
</span><span class="python1-space">        </span><span class="python1-identifier">min_value</span><span class="python1-symbol">=</span><span class="python1-number">5</span><span class="python1-symbol">,
</span><span class="python1-space">        </span><span class="python1-identifier">max_value</span><span class="python1-symbol">=</span><span class="python1-number">50</span><span class="python1-symbol">,
</span><span class="python1-space">        </span><span class="python1-identifier">value</span><span class="python1-symbol">=</span><span class="python1-number">20</span><span class="python1-symbol">,
</span><span class="python1-space">        </span><span class="python1-identifier">step</span><span class="python1-symbol">=</span><span class="python1-number">1</span><span class="python1-symbol">,
</span><span class="python1-space">        </span><span class="python1-nonreservedkeyword">help</span><span class="python1-symbol">=</span><span class="python1-string">&quot;Percentage of data to use for testing&quot;
</span><span class="python1-space">    </span><span class="python1-symbol">)
</span><span class="python1-space">    </span><span class="python1-identifier">test_size</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">test_size</span><span class="python1-space"> </span><span class="python1-symbol">/</span><span class="python1-space"> </span><span class="python1-number">100
</span><span class="python1-space">    
    </span><span class="python1-comment"># ==========================================
</span><span class="python1-space">    </span><span class="python1-comment"># 4. Random State
</span><span class="python1-space">    </span><span class="python1-comment"># ==========================================
</span><span class="python1-space">    </span><span class="python1-identifier">random_state</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">sidebar</span><span class="python1-symbol">.</span><span class="python1-identifier">number_input</span><span class="python1-symbol">(
</span><span class="python1-space">        </span><span class="python1-string">&quot;Random seed&quot;</span><span class="python1-symbol">,
</span><span class="python1-space">        </span><span class="python1-identifier">value</span><span class="python1-symbol">=</span><span class="python1-number">42</span><span class="python1-symbol">,
</span><span class="python1-space">        </span><span class="python1-nonreservedkeyword">help</span><span class="python1-symbol">=</span><span class="python1-string">&quot;For reproducibility&quot;
</span><span class="python1-space">    </span><span class="python1-symbol">)
</span><span class="python1-space">    
    </span><span class="python1-comment"># ==========================================
</span><span class="python1-space">    </span><span class="python1-comment"># Data Preprocessing
</span><span class="python1-space">    </span><span class="python1-comment"># ==========================================
</span><span class="python1-space">    </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">sidebar</span><span class="python1-symbol">.</span><span class="python1-identifier">subheader</span><span class="python1-symbol">(</span><span class="python1-string">&quot;4. Data Preprocessing&quot;</span><span class="python1-symbol">)
</span><span class="python1-space">    
    </span><span class="python1-comment"># Extract features and target
</span><span class="python1-space">    </span><span class="python1-identifier">X</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">data</span><span class="python1-symbol">[</span><span class="python1-identifier">feature_columns</span><span class="python1-symbol">].</span><span class="python1-identifier">copy</span><span class="python1-symbol">()
</span><span class="python1-space">    </span><span class="python1-identifier">y</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">data</span><span class="python1-symbol">[</span><span class="python1-identifier">target_column</span><span class="python1-symbol">].</span><span class="python1-identifier">copy</span><span class="python1-symbol">()
</span><span class="python1-space">    
    </span><span class="python1-comment"># Handle missing values
</span><span class="python1-space">    </span><span class="python1-reservedword">if</span><span class="python1-space"> </span><span class="python1-identifier">X</span><span class="python1-symbol">.</span><span class="python1-identifier">isnull</span><span class="python1-symbol">().</span><span class="python1-identifier">sum</span><span class="python1-symbol">().</span><span class="python1-identifier">sum</span><span class="python1-symbol">()</span><span class="python1-space"> </span><span class="python1-symbol">&gt;</span><span class="python1-space"> </span><span class="python1-number">0</span><span class="python1-symbol">:
</span><span class="python1-space">        </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">warning</span><span class="python1-symbol">(</span><span class="python1-string">&quot;вљ пёЏ Missing values detected in features!&quot;</span><span class="python1-symbol">)
</span><span class="python1-space">        </span><span class="python1-identifier">handle_missing</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">sidebar</span><span class="python1-symbol">.</span><span class="python1-identifier">radio</span><span class="python1-symbol">(
</span><span class="python1-space">            </span><span class="python1-string">&quot;How to handle missing values?&quot;</span><span class="python1-symbol">,
</span><span class="python1-space">            </span><span class="python1-symbol">[</span><span class="python1-string">&quot;Drop rows&quot;</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-string">&quot;Fill with mean&quot;</span><span class="python1-symbol">]
</span><span class="python1-space">        </span><span class="python1-symbol">)
</span><span class="python1-space">        </span><span class="python1-reservedword">if</span><span class="python1-space"> </span><span class="python1-identifier">handle_missing</span><span class="python1-space"> </span><span class="python1-symbol">==</span><span class="python1-space"> </span><span class="python1-string">&quot;Drop rows&quot;</span><span class="python1-symbol">:
</span><span class="python1-space">            </span><span class="python1-identifier">X</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">X</span><span class="python1-symbol">.</span><span class="python1-identifier">dropna</span><span class="python1-symbol">()
</span><span class="python1-space">            </span><span class="python1-identifier">y</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">y</span><span class="python1-symbol">[</span><span class="python1-identifier">X</span><span class="python1-symbol">.</span><span class="python1-identifier">index</span><span class="python1-symbol">]
</span><span class="python1-space">        </span><span class="python1-reservedword">else</span><span class="python1-symbol">:
</span><span class="python1-space">            </span><span class="python1-identifier">X</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">X</span><span class="python1-symbol">.</span><span class="python1-identifier">fillna</span><span class="python1-symbol">(</span><span class="python1-identifier">X</span><span class="python1-symbol">.</span><span class="python1-identifier">mean</span><span class="python1-symbol">())
</span><span class="python1-space">    
    </span><span class="python1-comment"># Encode categorical features
</span><span class="python1-space">    </span><span class="python1-identifier">categorical_cols</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">X</span><span class="python1-symbol">.</span><span class="python1-identifier">select_dtypes</span><span class="python1-symbol">(</span><span class="python1-identifier">include</span><span class="python1-symbol">=[</span><span class="python1-string">'object'</span><span class="python1-symbol">]).</span><span class="python1-identifier">columns
</span><span class="python1-space">    </span><span class="python1-identifier">label_encoders</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-symbol">{}
</span><span class="python1-space">    
    </span><span class="python1-reservedword">if</span><span class="python1-space"> </span><span class="python1-nonreservedkeyword">len</span><span class="python1-symbol">(</span><span class="python1-identifier">categorical_cols</span><span class="python1-symbol">)</span><span class="python1-space"> </span><span class="python1-symbol">&gt;</span><span class="python1-space"> </span><span class="python1-number">0</span><span class="python1-symbol">:
</span><span class="python1-space">        </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">info</span><span class="python1-symbol">(</span><span class="python1-identifier">f</span><span class="python1-string">&quot;Encoding categorical columns: {', '.join(categorical_cols)}&quot;</span><span class="python1-symbol">)
</span><span class="python1-space">        </span><span class="python1-reservedword">for</span><span class="python1-space"> </span><span class="python1-identifier">col</span><span class="python1-space"> </span><span class="python1-reservedword">in</span><span class="python1-space"> </span><span class="python1-identifier">categorical_cols</span><span class="python1-symbol">:
</span><span class="python1-space">            </span><span class="python1-identifier">le</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">LabelEncoder</span><span class="python1-symbol">()
</span><span class="python1-space">            </span><span class="python1-identifier">X</span><span class="python1-symbol">[</span><span class="python1-identifier">col</span><span class="python1-symbol">]</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">le</span><span class="python1-symbol">.</span><span class="python1-identifier">fit_transform</span><span class="python1-symbol">(</span><span class="python1-identifier">X</span><span class="python1-symbol">[</span><span class="python1-identifier">col</span><span class="python1-symbol">].</span><span class="python1-identifier">astype</span><span class="python1-symbol">(</span><span class="python1-nonreservedkeyword">str</span><span class="python1-symbol">))
</span><span class="python1-space">            </span><span class="python1-identifier">label_encoders</span><span class="python1-symbol">[</span><span class="python1-identifier">col</span><span class="python1-symbol">]</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">le
</span><span class="python1-space">    
    </span><span class="python1-comment"># Encode target if categorical
</span><span class="python1-space">    </span><span class="python1-identifier">target_encoder</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-nonreservedkeyword">None
</span><span class="python1-space">    </span><span class="python1-reservedword">if</span><span class="python1-space"> </span><span class="python1-identifier">y</span><span class="python1-symbol">.</span><span class="python1-identifier">dtype</span><span class="python1-space"> </span><span class="python1-symbol">==</span><span class="python1-space"> </span><span class="python1-string">'object'</span><span class="python1-symbol">:
</span><span class="python1-space">        </span><span class="python1-identifier">target_encoder</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">LabelEncoder</span><span class="python1-symbol">()
</span><span class="python1-space">        </span><span class="python1-identifier">y</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">target_encoder</span><span class="python1-symbol">.</span><span class="python1-identifier">fit_transform</span><span class="python1-symbol">(</span><span class="python1-identifier">y</span><span class="python1-symbol">)
</span><span class="python1-space">    
    </span><span class="python1-comment"># Convert to numpy arrays
</span><span class="python1-space">    </span><span class="python1-identifier">X</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">X</span><span class="python1-symbol">.</span><span class="python1-identifier">values
</span><span class="python1-space">    </span><span class="python1-identifier">y</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">np</span><span class="python1-symbol">.</span><span class="python1-identifier">array</span><span class="python1-symbol">(</span><span class="python1-identifier">y</span><span class="python1-symbol">)
</span><span class="python1-space">    
    </span><span class="python1-comment"># ==========================================
</span><span class="python1-space">    </span><span class="python1-comment"># Train Model
</span><span class="python1-space">    </span><span class="python1-comment"># ==========================================
</span><span class="python1-space">    </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">sidebar</span><span class="python1-symbol">.</span><span class="python1-identifier">subheader</span><span class="python1-symbol">(</span><span class="python1-string">&quot;5. Model Training&quot;</span><span class="python1-symbol">)
</span><span class="python1-space">    </span><span class="python1-reservedword">if</span><span class="python1-space"> </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">sidebar</span><span class="python1-symbol">.</span><span class="python1-identifier">button</span><span class="python1-symbol">(</span><span class="python1-string">&quot;рџљЂ Train Model&quot;</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">use_container_width</span><span class="python1-symbol">=</span><span class="python1-nonreservedkeyword">True</span><span class="python1-symbol">):
</span><span class="python1-space">        </span><span class="python1-reservedword">with</span><span class="python1-space"> </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">spinner</span><span class="python1-symbol">(</span><span class="python1-string">&quot;Training Naive Bayes classifier...&quot;</span><span class="python1-symbol">):
</span><span class="python1-space">            </span><span class="python1-comment"># Train the model
</span><span class="python1-space">            </span><span class="python1-identifier">results</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">naive_bayes_classifier</span><span class="python1-symbol">(
</span><span class="python1-space">                </span><span class="python1-identifier">X</span><span class="python1-symbol">=</span><span class="python1-identifier">X</span><span class="python1-symbol">,
</span><span class="python1-space">                </span><span class="python1-identifier">y</span><span class="python1-symbol">=</span><span class="python1-identifier">y</span><span class="python1-symbol">,
</span><span class="python1-space">                </span><span class="python1-identifier">test_size</span><span class="python1-symbol">=</span><span class="python1-identifier">test_size</span><span class="python1-symbol">,
</span><span class="python1-space">                </span><span class="python1-identifier">random_state</span><span class="python1-symbol">=</span><span class="python1-nonreservedkeyword">int</span><span class="python1-symbol">(</span><span class="python1-identifier">random_state</span><span class="python1-symbol">)
</span><span class="python1-space">            </span><span class="python1-symbol">)
</span><span class="python1-space">        
        </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">success</span><span class="python1-symbol">(</span><span class="python1-string">&quot;вњ… Model training completed!&quot;</span><span class="python1-symbol">)
</span><span class="python1-space">        
        </span><span class="python1-comment"># Display Results
</span><span class="python1-space">        </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">subheader</span><span class="python1-symbol">(</span><span class="python1-string">&quot;рџ“€ Model Results&quot;</span><span class="python1-symbol">)
</span><span class="python1-space">        
        </span><span class="python1-comment"># Create columns for metrics
</span><span class="python1-space">        </span><span class="python1-identifier">col1</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">col2</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">col3</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">columns</span><span class="python1-symbol">(</span><span class="python1-number">3</span><span class="python1-symbol">)
</span><span class="python1-space">        
        </span><span class="python1-reservedword">with</span><span class="python1-space"> </span><span class="python1-identifier">col1</span><span class="python1-symbol">:
</span><span class="python1-space">            </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">metric</span><span class="python1-symbol">(
</span><span class="python1-space">                </span><span class="python1-string">&quot;Training Accuracy&quot;</span><span class="python1-symbol">,
</span><span class="python1-space">                </span><span class="python1-identifier">f</span><span class="python1-string">&quot;{results['training_accuracy']:.4f}&quot;</span><span class="python1-symbol">,
</span><span class="python1-space">                </span><span class="python1-identifier">f</span><span class="python1-string">&quot;{results['training_accuracy']*100:.2f}%&quot;
</span><span class="python1-space">            </span><span class="python1-symbol">)
</span><span class="python1-space">        
        </span><span class="python1-reservedword">with</span><span class="python1-space"> </span><span class="python1-identifier">col2</span><span class="python1-symbol">:
</span><span class="python1-space">            </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">metric</span><span class="python1-symbol">(
</span><span class="python1-space">                </span><span class="python1-string">&quot;Testing Accuracy&quot;</span><span class="python1-symbol">,
</span><span class="python1-space">                </span><span class="python1-identifier">f</span><span class="python1-string">&quot;{results['testing_accuracy']:.4f}&quot;</span><span class="python1-symbol">,
</span><span class="python1-space">                </span><span class="python1-identifier">f</span><span class="python1-string">&quot;{results['testing_accuracy']*100:.2f}%&quot;
</span><span class="python1-space">            </span><span class="python1-symbol">)
</span><span class="python1-space">        
        </span><span class="python1-reservedword">with</span><span class="python1-space"> </span><span class="python1-identifier">col3</span><span class="python1-symbol">:
</span><span class="python1-space">            </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">metric</span><span class="python1-symbol">(
</span><span class="python1-space">                </span><span class="python1-string">&quot;Train-Test Samples&quot;</span><span class="python1-symbol">,
</span><span class="python1-space">                </span><span class="python1-identifier">f</span><span class="python1-string">&quot;{results['train_size']}/{results['test_size']}&quot;
</span><span class="python1-space">            </span><span class="python1-symbol">)
</span><span class="python1-space">        
        </span><span class="python1-comment"># Display Confusion Matrix
</span><span class="python1-space">        </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">subheader</span><span class="python1-symbol">(</span><span class="python1-string">&quot;рџ”Ќ Confusion Matrix&quot;</span><span class="python1-symbol">)
</span><span class="python1-space">        
        </span><span class="python1-identifier">conf_matrix</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">results</span><span class="python1-symbol">[</span><span class="python1-string">'confusion_matrix'</span><span class="python1-symbol">]
</span><span class="python1-space">        
        </span><span class="python1-comment"># Validate confusion matrix
</span><span class="python1-space">        </span><span class="python1-reservedword">if</span><span class="python1-space"> </span><span class="python1-identifier">conf_matrix</span><span class="python1-space"> </span><span class="python1-reservedword">is</span><span class="python1-space"> </span><span class="python1-nonreservedkeyword">None</span><span class="python1-space"> </span><span class="python1-reservedword">or</span><span class="python1-space"> </span><span class="python1-nonreservedkeyword">len</span><span class="python1-symbol">(</span><span class="python1-identifier">conf_matrix</span><span class="python1-symbol">)</span><span class="python1-space"> </span><span class="python1-symbol">==</span><span class="python1-space"> </span><span class="python1-number">0</span><span class="python1-symbol">:
</span><span class="python1-space">            </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">error</span><span class="python1-symbol">(</span><span class="python1-string">&quot;Confusion matrix is empty!&quot;</span><span class="python1-symbol">)
</span><span class="python1-space">        </span><span class="python1-reservedword">else</span><span class="python1-symbol">:
</span><span class="python1-space">            </span><span class="python1-comment"># Create a more detailed view
</span><span class="python1-space">            </span><span class="python1-identifier">col1</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">col2</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">columns</span><span class="python1-symbol">(</span><span class="python1-number">2</span><span class="python1-symbol">)
</span><span class="python1-space">            
            </span><span class="python1-reservedword">with</span><span class="python1-space"> </span><span class="python1-identifier">col1</span><span class="python1-symbol">:
</span><span class="python1-space">                </span><span class="python1-comment"># Heatmap
</span><span class="python1-space">                </span><span class="python1-identifier">fig</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">ax</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">plt</span><span class="python1-symbol">.</span><span class="python1-identifier">subplots</span><span class="python1-symbol">(</span><span class="python1-identifier">figsize</span><span class="python1-symbol">=(</span><span class="python1-number">8</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-number">6</span><span class="python1-symbol">))
</span><span class="python1-space">                
                </span><span class="python1-comment"># Prepare labels based on matrix shape
</span><span class="python1-space">                </span><span class="python1-identifier">heatmap_kwargs</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-symbol">{
</span><span class="python1-space">                    </span><span class="python1-string">'data'</span><span class="python1-symbol">:</span><span class="python1-space"> </span><span class="python1-identifier">conf_matrix</span><span class="python1-symbol">,
</span><span class="python1-space">                    </span><span class="python1-string">'annot'</span><span class="python1-symbol">:</span><span class="python1-space"> </span><span class="python1-nonreservedkeyword">True</span><span class="python1-symbol">,
</span><span class="python1-space">                    </span><span class="python1-string">'fmt'</span><span class="python1-symbol">:</span><span class="python1-space"> </span><span class="python1-string">'d'</span><span class="python1-symbol">,
</span><span class="python1-space">                    </span><span class="python1-string">'cmap'</span><span class="python1-symbol">:</span><span class="python1-space"> </span><span class="python1-string">'Blues'</span><span class="python1-symbol">,
</span><span class="python1-space">                    </span><span class="python1-string">'cbar'</span><span class="python1-symbol">:</span><span class="python1-space"> </span><span class="python1-nonreservedkeyword">True</span><span class="python1-symbol">,
</span><span class="python1-space">                    </span><span class="python1-string">'ax'</span><span class="python1-symbol">:</span><span class="python1-space"> </span><span class="python1-identifier">ax
</span><span class="python1-space">                </span><span class="python1-symbol">}
</span><span class="python1-space">                
                </span><span class="python1-reservedword">if</span><span class="python1-space"> </span><span class="python1-identifier">conf_matrix</span><span class="python1-symbol">.</span><span class="python1-identifier">shape</span><span class="python1-symbol">[</span><span class="python1-number">0</span><span class="python1-symbol">]</span><span class="python1-space"> </span><span class="python1-symbol">==</span><span class="python1-space"> </span><span class="python1-number">2</span><span class="python1-symbol">:
</span><span class="python1-space">                    </span><span class="python1-identifier">heatmap_kwargs</span><span class="python1-symbol">[</span><span class="python1-string">'xticklabels'</span><span class="python1-symbol">]</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-symbol">[</span><span class="python1-string">'Negative'</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-string">'Positive'</span><span class="python1-symbol">]
</span><span class="python1-space">                    </span><span class="python1-identifier">heatmap_kwargs</span><span class="python1-symbol">[</span><span class="python1-string">'yticklabels'</span><span class="python1-symbol">]</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-symbol">[</span><span class="python1-string">'Negative'</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-string">'Positive'</span><span class="python1-symbol">]
</span><span class="python1-space">                
                </span><span class="python1-identifier">sns</span><span class="python1-symbol">.</span><span class="python1-identifier">heatmap</span><span class="python1-symbol">(**</span><span class="python1-identifier">heatmap_kwargs</span><span class="python1-symbol">)
</span><span class="python1-space">                </span><span class="python1-identifier">ax</span><span class="python1-symbol">.</span><span class="python1-identifier">set_xlabel</span><span class="python1-symbol">(</span><span class="python1-string">'Predicted Label'</span><span class="python1-symbol">)
</span><span class="python1-space">                </span><span class="python1-identifier">ax</span><span class="python1-symbol">.</span><span class="python1-identifier">set_ylabel</span><span class="python1-symbol">(</span><span class="python1-string">'True Label'</span><span class="python1-symbol">)
</span><span class="python1-space">                </span><span class="python1-identifier">ax</span><span class="python1-symbol">.</span><span class="python1-identifier">set_title</span><span class="python1-symbol">(</span><span class="python1-string">'Confusion Matrix Heatmap'</span><span class="python1-symbol">)
</span><span class="python1-space">                </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">pyplot</span><span class="python1-symbol">(</span><span class="python1-identifier">fig</span><span class="python1-symbol">)
</span><span class="python1-space">            
            </span><span class="python1-reservedword">with</span><span class="python1-space"> </span><span class="python1-identifier">col2</span><span class="python1-symbol">:
</span><span class="python1-space">                </span><span class="python1-comment"># Text representation
</span><span class="python1-space">                </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">text</span><span class="python1-symbol">(</span><span class="python1-string">&quot;Confusion Matrix:&quot;</span><span class="python1-symbol">)
</span><span class="python1-space">                </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">code</span><span class="python1-symbol">(</span><span class="python1-nonreservedkeyword">str</span><span class="python1-symbol">(</span><span class="python1-identifier">conf_matrix</span><span class="python1-symbol">))
</span><span class="python1-space">                
                </span><span class="python1-comment"># Calculate additional metrics
</span><span class="python1-space">                </span><span class="python1-reservedword">if</span><span class="python1-space"> </span><span class="python1-identifier">conf_matrix</span><span class="python1-symbol">.</span><span class="python1-identifier">shape</span><span class="python1-symbol">[</span><span class="python1-number">0</span><span class="python1-symbol">]</span><span class="python1-space"> </span><span class="python1-symbol">==</span><span class="python1-space"> </span><span class="python1-number">2</span><span class="python1-symbol">:</span><span class="python1-space">  </span><span class="python1-comment"># Binary classification
</span><span class="python1-space">                    </span><span class="python1-identifier">tn</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">fp</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">fn</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">tp</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">conf_matrix</span><span class="python1-symbol">.</span><span class="python1-identifier">ravel</span><span class="python1-symbol">()
</span><span class="python1-space">                    </span><span class="python1-identifier">precision</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">tp</span><span class="python1-space"> </span><span class="python1-symbol">/</span><span class="python1-space"> </span><span class="python1-symbol">(</span><span class="python1-identifier">tp</span><span class="python1-space"> </span><span class="python1-symbol">+</span><span class="python1-space"> </span><span class="python1-identifier">fp</span><span class="python1-symbol">)</span><span class="python1-space"> </span><span class="python1-reservedword">if</span><span class="python1-space"> </span><span class="python1-symbol">(</span><span class="python1-identifier">tp</span><span class="python1-space"> </span><span class="python1-symbol">+</span><span class="python1-space"> </span><span class="python1-identifier">fp</span><span class="python1-symbol">)</span><span class="python1-space"> </span><span class="python1-symbol">&gt;</span><span class="python1-space"> </span><span class="python1-number">0</span><span class="python1-space"> </span><span class="python1-reservedword">else</span><span class="python1-space"> </span><span class="python1-number">0
</span><span class="python1-space">                    </span><span class="python1-identifier">recall</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">tp</span><span class="python1-space"> </span><span class="python1-symbol">/</span><span class="python1-space"> </span><span class="python1-symbol">(</span><span class="python1-identifier">tp</span><span class="python1-space"> </span><span class="python1-symbol">+</span><span class="python1-space"> </span><span class="python1-identifier">fn</span><span class="python1-symbol">)</span><span class="python1-space"> </span><span class="python1-reservedword">if</span><span class="python1-space"> </span><span class="python1-symbol">(</span><span class="python1-identifier">tp</span><span class="python1-space"> </span><span class="python1-symbol">+</span><span class="python1-space"> </span><span class="python1-identifier">fn</span><span class="python1-symbol">)</span><span class="python1-space"> </span><span class="python1-symbol">&gt;</span><span class="python1-space"> </span><span class="python1-number">0</span><span class="python1-space"> </span><span class="python1-reservedword">else</span><span class="python1-space"> </span><span class="python1-number">0
</span><span class="python1-space">                    </span><span class="python1-identifier">f1</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-number">2</span><span class="python1-space"> </span><span class="python1-symbol">*</span><span class="python1-space"> </span><span class="python1-symbol">(</span><span class="python1-identifier">precision</span><span class="python1-space"> </span><span class="python1-symbol">*</span><span class="python1-space"> </span><span class="python1-identifier">recall</span><span class="python1-symbol">)</span><span class="python1-space"> </span><span class="python1-symbol">/</span><span class="python1-space"> </span><span class="python1-symbol">(</span><span class="python1-identifier">precision</span><span class="python1-space"> </span><span class="python1-symbol">+</span><span class="python1-space"> </span><span class="python1-identifier">recall</span><span class="python1-symbol">)</span><span class="python1-space"> </span><span class="python1-reservedword">if</span><span class="python1-space"> </span><span class="python1-symbol">(</span><span class="python1-identifier">precision</span><span class="python1-space"> </span><span class="python1-symbol">+</span><span class="python1-space"> </span><span class="python1-identifier">recall</span><span class="python1-symbol">)</span><span class="python1-space"> </span><span class="python1-symbol">&gt;</span><span class="python1-space"> </span><span class="python1-number">0</span><span class="python1-space"> </span><span class="python1-reservedword">else</span><span class="python1-space"> </span><span class="python1-number">0
</span><span class="python1-space">                    
                    </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">subheader</span><span class="python1-symbol">(</span><span class="python1-string">&quot;рџ“Љ Additional Metrics (Binary Classification)&quot;</span><span class="python1-symbol">)
</span><span class="python1-space">                    </span><span class="python1-identifier">metric_col1</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">metric_col2</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">metric_col3</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">columns</span><span class="python1-symbol">(</span><span class="python1-number">3</span><span class="python1-symbol">)
</span><span class="python1-space">                    
                    </span><span class="python1-reservedword">with</span><span class="python1-space"> </span><span class="python1-identifier">metric_col1</span><span class="python1-symbol">:
</span><span class="python1-space">                        </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">metric</span><span class="python1-symbol">(</span><span class="python1-string">&quot;Precision&quot;</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">f</span><span class="python1-string">&quot;{precision:.4f}&quot;</span><span class="python1-symbol">)
</span><span class="python1-space">                    </span><span class="python1-reservedword">with</span><span class="python1-space"> </span><span class="python1-identifier">metric_col2</span><span class="python1-symbol">:
</span><span class="python1-space">                        </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">metric</span><span class="python1-symbol">(</span><span class="python1-string">&quot;Recall&quot;</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">f</span><span class="python1-string">&quot;{recall:.4f}&quot;</span><span class="python1-symbol">)
</span><span class="python1-space">                    </span><span class="python1-reservedword">with</span><span class="python1-space"> </span><span class="python1-identifier">metric_col3</span><span class="python1-symbol">:
</span><span class="python1-space">                        </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">metric</span><span class="python1-symbol">(</span><span class="python1-string">&quot;F1-Score&quot;</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">f</span><span class="python1-string">&quot;{f1:.4f}&quot;</span><span class="python1-symbol">)
</span><span class="python1-space">        
        </span><span class="python1-comment"># Display configuration used
</span><span class="python1-space">        </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">subheader</span><span class="python1-symbol">(</span><span class="python1-string">&quot;вљ™пёЏ Configuration Used&quot;</span><span class="python1-symbol">)
</span><span class="python1-space">        </span><span class="python1-identifier">config_col1</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">config_col2</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">config_col3</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">columns</span><span class="python1-symbol">(</span><span class="python1-number">3</span><span class="python1-symbol">)
</span><span class="python1-space">        
        </span><span class="python1-reservedword">with</span><span class="python1-space"> </span><span class="python1-identifier">config_col1</span><span class="python1-symbol">:
</span><span class="python1-space">            </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">write</span><span class="python1-symbol">(</span><span class="python1-string">&quot;**Features Used:**&quot;</span><span class="python1-symbol">)
</span><span class="python1-space">            </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">write</span><span class="python1-symbol">(</span><span class="python1-identifier">feature_columns</span><span class="python1-symbol">)
</span><span class="python1-space">        
        </span><span class="python1-reservedword">with</span><span class="python1-space"> </span><span class="python1-identifier">config_col2</span><span class="python1-symbol">:
</span><span class="python1-space">            </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">write</span><span class="python1-symbol">(</span><span class="python1-string">&quot;**Target Column:**&quot;</span><span class="python1-symbol">)
</span><span class="python1-space">            </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">write</span><span class="python1-symbol">(</span><span class="python1-identifier">target_column</span><span class="python1-symbol">)
</span><span class="python1-space">        
        </span><span class="python1-reservedword">with</span><span class="python1-space"> </span><span class="python1-identifier">config_col3</span><span class="python1-symbol">:
</span><span class="python1-space">            </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">write</span><span class="python1-symbol">(</span><span class="python1-string">&quot;**Split Configuration:**&quot;</span><span class="python1-symbol">)
</span><span class="python1-space">            </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">write</span><span class="python1-symbol">(</span><span class="python1-identifier">f</span><span class="python1-string">&quot;Train: {int((1-test_size)*100)}%&quot;</span><span class="python1-symbol">)
</span><span class="python1-space">            </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">write</span><span class="python1-symbol">(</span><span class="python1-identifier">f</span><span class="python1-string">&quot;Test: {int(test_size*100)}%&quot;</span><span class="python1-symbol">)

</span><span class="python1-reservedword">else</span><span class="python1-symbol">:
</span><span class="python1-space">    </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">info</span><span class="python1-symbol">(</span><span class="python1-string">&quot;рџ‘€ Upload a CSV file from the sidebar to get started!&quot;</span><span class="python1-symbol">)
</span><span class="python1-space">    
    </span><span class="python1-comment"># Show example of expected CSV format
</span><span class="python1-space">    </span><span class="python1-reservedword">with</span><span class="python1-space"> </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">expander</span><span class="python1-symbol">(</span><span class="python1-string">&quot;в„№пёЏ Expected CSV Format&quot;</span><span class="python1-symbol">):
</span><span class="python1-space">        </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">write</span><span class="python1-symbol">(</span><span class="python1-string">&quot;Your CSV file should have columns for features and a target column.&quot;</span><span class="python1-symbol">)
</span><span class="python1-space">        </span><span class="python1-identifier">example_data</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">pd</span><span class="python1-symbol">.</span><span class="python1-identifier">DataFrame</span><span class="python1-symbol">({
</span><span class="python1-space">            </span><span class="python1-string">'Feature1'</span><span class="python1-symbol">:</span><span class="python1-space"> </span><span class="python1-symbol">[</span><span class="python1-float">1.5</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-float">2.3</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-float">3.1</span><span class="python1-symbol">],
</span><span class="python1-space">            </span><span class="python1-string">'Feature2'</span><span class="python1-symbol">:</span><span class="python1-space"> </span><span class="python1-symbol">[</span><span class="python1-float">4.2</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-float">5.1</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-float">6.3</span><span class="python1-symbol">],
</span><span class="python1-space">            </span><span class="python1-string">'Feature3'</span><span class="python1-symbol">:</span><span class="python1-space"> </span><span class="python1-symbol">[</span><span class="python1-float">7.0</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-float">8.5</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-float">9.2</span><span class="python1-symbol">],
</span><span class="python1-space">            </span><span class="python1-string">'Target'</span><span class="python1-symbol">:</span><span class="python1-space"> </span><span class="python1-symbol">[</span><span class="python1-string">'Class_A'</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-string">'Class_B'</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-string">'Class_A'</span><span class="python1-symbol">]
</span><span class="python1-space">        </span><span class="python1-symbol">})
</span><span class="python1-space">        </span><span class="python1-identifier">st</span><span class="python1-symbol">.</span><span class="python1-identifier">dataframe</span><span class="python1-symbol">(</span><span class="python1-identifier">example_data</span><span class="python1-symbol">)

</span></code></pre><!--EndFragment--></body>
</html>